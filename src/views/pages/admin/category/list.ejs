<div id="admin-category-list" v-cloak>
  <div class="container">
    <div class="row">
      <div class="col text-right">
        <a class="btn btn-info btn-sm" href="/<%= organization.handleId %>/admin/category/create"><i
            class="fas fa-plus-circle"></i> <%= __('Add new category') %></a>
      </div>
    </div>

    <div id="cloud-error" class="row">
      <div class="col-sm-6">
        <p class="text-danger" v-if="cloudError">
          <%= __("An error occurred while processing the request. Please check the information and try again. If the error persists, please contact your administrator") %>
        </p>
      </div>
    </div>

    <div class="row mt-4">
      <div class="col-auto">
        <h4><%= __('Categories') %></h4>
      </div>
      <div class="col">
        <span class="text-muted"><%= __('You can change the display order by dragging') %></span>
      </div>
    </div>
    <div class="mt-3">
      <draggable v-model="categories" @start="inDrag=true" @end="inDrag=false" v-bind="dragOptions" @change="onChanged">
        <transition-group type="transition" :name="!inDrag ? 'flip-list' : null">
          <div class="card category-card mb-2" v-for="item in categories" :key="item.id">
            <div class="card-body">
              <div class="card-title">
                <a class="" :href="link(item)">{{ item.name }}</a>
              </div>
              <div class="row">
                <div class="col-auto">
                  <span class="card-text"><%= __('Display order') %>:{{ item.displayOrder }}</span>
                </div>
                <div class="col-2">
                  <span class="badge badge-warning" v-if="item.deleted"><%= __('Invalid category') %></span>
                </div>
                <div class="col text-right">
                  <a :href="link(item)" class="btn btn-info btn-sm"><i class="far fa-edit"></i> <%= __('Edit') %></a>
                </div>
              </div>
            </div>
          </div>
        </transition-group>
      </draggable>
    </div>
  </div>
  <ajax-form id="update-order-form" action="updateCategoryOrder" :syncing.sync="syncing" :cloud-error.sync="cloudError"
    @submitted="submittedForm" @rejected="onCloudError" :handle-parsing="handleParsingForm">
  </ajax-form>
</div>
<%- /* Expose server-rendered data as window.SAILS_LOCALS :: */ exposeLocalsToBrowser() %>