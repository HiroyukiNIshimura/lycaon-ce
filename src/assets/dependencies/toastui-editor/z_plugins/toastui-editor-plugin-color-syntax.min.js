/*!
 * TOAST UI Editor : Color Syntax Plugin
 * @version 3.0.1 | Tue Jul 13 2021
 * @author NHN FE Development Lab <dl_javascript@nhn.com>
 * @license MIT
 */
!function webpackUniversalModuleDefinition(root,factory){"object"==typeof exports&&"object"==typeof module?module.exports=factory(require("tui-color-picker")):"function"==typeof define&&define.amd?define(["tui-color-picker"],factory):"object"==typeof exports?exports.toastui=factory(require("tui-color-picker")):(root.toastui=root.toastui||{},root.toastui.Editor=root.toastui.Editor||{},root.toastui.Editor.plugin=root.toastui.Editor.plugin||{},root.toastui.Editor.plugin.colorSyntax=factory(root.tui.colorPicker))}(window,(function(__WEBPACK_EXTERNAL_MODULE__227__){return function(){"use strict";var __webpack_modules__={227:function(module){module.exports=__WEBPACK_EXTERNAL_MODULE__227__}},__webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(void 0!==cachedModule)return cachedModule.exports;var module=__webpack_module_cache__[moduleId]={exports:{}};return __webpack_modules__[moduleId](module,module.exports,__webpack_require__),module.exports}__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module.default}:function(){return module};return __webpack_require__.d(getter,{a:getter}),getter},__webpack_require__.d=function(exports,definition){for(var key in definition)__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)&&Object.defineProperty(exports,key,{enumerable:!0,get:definition[key]})},__webpack_require__.o=function(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)};var __webpack_exports__={};return function(){__webpack_require__.d(__webpack_exports__,{default:function(){return colorSyntaxPlugin}});var tui_color_picker__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(227),tui_color_picker__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(tui_color_picker__WEBPACK_IMPORTED_MODULE_0__),PREFIX="toastui-editor-",currentEditorEl;function createApplyButton(text){var button=document.createElement("button");return button.setAttribute("type","button"),button.textContent=text,button}function createToolbarItemOption(colorPickerContainer){return{name:"color",tooltip:"Text color",className:PREFIX+"toolbar-icons color",popup:{className:PREFIX+"popup-color",body:colorPickerContainer,style:{width:"auto"}}}}function createSelection(tr,selection,SelectionClass,openTag,closeTag){var mapping=tr.mapping,doc=tr.doc,from=selection.from,to=selection.to,empty=selection.empty,mappedFrom=mapping.map(from)+openTag.length,mappedTo=mapping.map(to)-closeTag.length;return empty?SelectionClass.create(doc,mappedTo,mappedTo):SelectionClass.create(doc,mappedFrom,mappedTo)}function colorSyntaxPlugin(context,options){void 0===options&&(options={});var eventEmitter=context.eventEmitter,i18n=context.i18n,_a=context.usageStatistics,usageStatistics=void 0===_a||_a,pmState=context.pmState,preset=options.preset,container=document.createElement("div"),colorPickerOption={container:container,usageStatistics:usageStatistics};preset&&(colorPickerOption.preset=preset);var colorPicker=tui_color_picker__WEBPACK_IMPORTED_MODULE_0___default().create(colorPickerOption),button=createApplyButton(i18n.get("OK")),toolbarItem;return eventEmitter.listen("focus",(function(editType){var containerClassName=PREFIX+("markdown"===editType?"md":"ww")+"-container";currentEditorEl=document.querySelector("."+containerClassName+" .ProseMirror")})),container.addEventListener("click",(function(ev){if("button"===ev.target.getAttribute("type")){var selectedColor=colorPicker.getColor();eventEmitter.emit("command","color",{selectedColor:selectedColor}),eventEmitter.emit("closePopup"),currentEditorEl.focus()}})),colorPicker.slider.toggle(!0),container.appendChild(button),{markdownCommands:{color:function(_a,_b,dispatch){var selectedColor=_a.selectedColor,tr=_b.tr,selection=_b.selection,schema=_b.schema;if(selectedColor){var slice=selection.content(),textContent,openTag='<span style="color: '+selectedColor+'">',closeTag="</span>",colored=""+openTag+slice.content.textBetween(0,slice.content.size,"\n")+closeTag;return tr.replaceSelectionWith(schema.text(colored)).setSelection(createSelection(tr,selection,pmState.TextSelection,openTag,closeTag)),dispatch(tr),!0}return!1}},wysiwygCommands:{color:function(_a,_b,dispatch){var selectedColor=_a.selectedColor,tr=_b.tr,selection=_b.selection,schema=_b.schema;if(selectedColor){var from=selection.from,to=selection.to,attrs={htmlAttrs:{style:"color: "+selectedColor}},mark=schema.marks.span.create(attrs);return tr.addMark(from,to,mark),dispatch(tr),!0}return!1}},toolbarItems:[{groupIndex:0,itemIndex:3,item:createToolbarItemOption(container)}],toHTMLRenderers:{htmlInline:{span:function(node,_a){var entering;return _a.entering?{type:"openTag",tagName:"span",attributes:node.attrs}:{type:"closeTag",tagName:"span"}}}}}}}(),__webpack_exports__=__webpack_exports__.default}()}));